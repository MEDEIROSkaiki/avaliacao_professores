{% extends 'base.html' %}
{% load static %}

{% block content %}
<main class="admin-container">
    <section class="admin-panel">
        <h1>Lista de Professores Cadastrados</h1>

        {% if request.user.is_staff %}
        <div style="margin-bottom: 25px; display: flex; justify-content: flex-end;">
            <a href="{% url 'adicionar_usuario' %}" class="btn">
                + Novo Usuário
            </a>
        </div>
        {% endif %}
        
        <div class="professor-list-container">
            <div class="list-header" style="
                display: grid; 
                grid-template-columns: 2fr 2fr 3fr 1fr; 
                gap: 20px; 
                padding: 15px 20px; 
                border-bottom: 2px solid var(--cinza-claro); 
                font-weight: 600; 
                color: var(--azul-marinho);
                background-color: var(--painel-central);
                border-radius: 8px 8px 0 0;
            ">
                <span>Nome</span>
                <span>Email</span>
                <span>Disciplinas</span>
                <span>Ações</span>
            </div>

            {% for professor in professores %}
            <div class="professor-item" style="
                display: grid; 
                grid-template-columns: 2fr 2fr 3fr 1fr; 
                gap: 20px; 
                padding: 15px 20px; 
                border-bottom: 1px solid var(--cinza-claro);
                align-items: center;
                color: var(--verde-escuro-letras);
            ">
                
                <div style="display: flex; align-items: center;">
                    {% if professor.foto %}
                        <img src="{{ professor.foto.url }}" alt="Foto de {{ professor.user.first_name }}" style="
                            width: 30px; 
                            height: 30px; 
                            border-radius: 50%; /* Deixa a foto redonda */
                            object-fit: cover; /* Garante que a imagem não distorça */
                            margin-right: 15px;
                        ">
                    {% else %}
                        <i class="fas fa-user-circle" style="
                            font-size: 30px; 
                            color: var(--azul-marinho); 
                            margin-right: 15px;
                        "></i> 
                    {% endif %}
                    
                    <span>{{ professor.user.first_name }} {{ professor.user.last_name }}</span>
                </div>
                
                <span>{{ professor.user.email }}</span>

                <span>
                    {% for dp in professor.user.disciplinas_pessoa.all %}
                        {{ dp.disciplina.nome }}
                        {% if not forloop.last %}, {% endif %} {% empty %}
                        <span style="opacity: 0.7;">Nenhuma disciplina</span>
                    {% endfor %}
                </span>

                <div>
                    <a href="{% url 'detalhes_professor' professor.id %}" class="btn" style="
                        padding: 8px 18px;
                        font-size: 0.9rem;
                        white-space: nowrap;
                    ">
                        Ver Detalhes
                    </a>
                </div>
            </div>
            {% empty %}
                <p style="padding: 20px; color: var(--cinza-escuro-letras);">Nenhum professor cadastrado ainda.</p>
            {% endfor %}
            
            </div>
    </section>
</main>
{% endblock content %}