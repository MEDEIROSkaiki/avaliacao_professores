{% extends 'base.html' %}
{% load static %}

{% block content %}
<main class="admin-container">
    <section class="admin-panel" style="max-width: 900px;">
        
        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
            {% if professor.foto %}
                <img src="{{ professor.foto.url }}" alt="Foto" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
            {% else %}
                <i class="fa-solid fa-user" style="font-size: 80px; color: var(--azul-acinzentado);"></i>
            {% endif %}
            <h1 style="margin: 0;">Editar Perfil: <br>{{ professor.user.get_full_name }}</h1>
        </div>

        <hr style="border: 1px solid var(--painel-central); margin: 30px 0;">

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <h2>Dados Pessoais e Foto</h2>
            
            <div class="form-group">
                <label>Nome:</label>
                {{ user_form.first_name }}
            </div>
            <div class="form-group">
                <label>Sobrenome:</label>
                {{ user_form.last_name }}
            </div>
            <div class="form-group">
                <label>Email:</label>
                {{ user_form.email }}
            </div>
            <div class="form-group">
                <label>Foto:</label>
                {{ professor_form.foto }}
            </div>
            
            <button type="submit" name="submit_profile" class="btn">Salvar Alterações do Perfil</button>
        </form>

        <hr style="border: 1px solid var(--painel-central); margin: 30px 0;">

        <form method="post">
            {% csrf_token %}
            <h2>Adicionar Disciplina</h2>
            <p>Adicione uma nova disciplina (já cadastrada) para este professor.</p>
            
            <div class="form-group">
                {{ disciplina_form.disciplina }}
            </div>
            
            <button type="submit" name="submit_disciplina" class="btn">Adicionar Disciplina</button>
        </form>
        
        <hr style="border: 1px solid var(--painel-central); margin: 30px 0;">

        <h2>Disciplinas Atuais</h2>
        {% if disciplinas_atuais %}
            <ul style="list-style-type: disc; margin-left: 20px; color: var(--verde-escuro-letras);">
            {% for dp in disciplinas_atuais %}
                <li>{{ dp.disciplina.nome }}</li>
            {% endfor %}
            </ul>
        {% else %}
            <p>Este professor ainda não ministra nenhuma disciplina.</p>
        {% endif %}

        <hr style="border: 1px solid var(--painel-central); margin: 30px 0;">
        
        <form method="post" onsubmit="return confirm('Tem certeza que deseja excluir este professor? Esta ação é irreversível.');">
            {% csrf_token %}
            <h2>Excluir Professor</h2>
            <p style="color: #E74C3C; font-weight: 500;">
                Atenção: Esta ação irá remover permanentemente o professor e todo o seu histórico (incluindo avaliações). Não pode ser desfeito.
            </p>
            <button type="submit" name="submit_delete" class="btn" style="background-color: #E74C3C; margin-top: 15px;">
                Excluir Professor Permanentemente
            </button>
        </form>
        </section>
</main>
{% endblock content %}